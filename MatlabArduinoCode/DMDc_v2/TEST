This is a critical systems identification challenge:

â“ How can I recover the open-loop dynamics of a system if I only have closed-loop data (e.g., from DMDc)?

The answer lies in carefully modeling the controller, and "decoupling" its effect from the closed-loop system.

ğŸ”„ Overview: From Closed-Loop to Open-Loop Dynamics
If you collect data under feedback control, what DMDc sees is:

ğ‘¥
ğ‘˜
+
1
=
ğ´
ğ‘¥
ğ‘˜
+
ğµ
ğ‘¢
ğ‘˜
=
ğ´
ğ‘¥
ğ‘˜
+
ğµ
ğ¾
ğ‘¥
ğ‘˜
=
(
ğ´
+
ğµ
ğ¾
)
ğ‘¥
ğ‘˜
x 
k+1
â€‹
 =Ax 
k
â€‹
 +Bu 
k
â€‹
 =Ax 
k
â€‹
 +BKx 
k
â€‹
 =(A+BK)x 
k
â€‹
 
So your DMDc (if input is 
ğ‘¢
ğ‘˜
=
ğ¾
ğ‘¥
ğ‘˜
u 
k
â€‹
 =Kx 
k
â€‹
 ) actually identifies:

ğ´
closed
=
ğ´
+
ğµ
ğ¾
A 
closed
â€‹
 =A+BK
Thus:

ğ´
=
ğ´
closed
âˆ’
ğµ
ğ¾
A=A 
closed
â€‹
 âˆ’BK
â€‹
 
If you know the controller gain 
ğ¾
K, and DMDc gives you 
ğ´
closed
A 
closed
â€‹
  and 
ğµ
B, you can recover the true open-loop dynamics 
ğ´
A.

âœ… Method 1: If You Know the Controller Gain 
ğ¾
K
Run DMDc on closed-loop data.

Let 
ğ´
ğ‘
=
ğ´
closed-loop
A 
c
â€‹
 =A 
closed-loop
â€‹
  from DMDc.

Use the known controller gain 
ğ¾
K to compute:

ğ´
=
ğ´
ğ‘
âˆ’
ğµ
ğ¾
A=A 
c
â€‹
 âˆ’BK
Thatâ€™s your open-loop dynamics.

ğŸ” This assumes that 
ğ‘¢
ğ‘˜
=
ğ¾
ğ‘¥
ğ‘˜
u 
k
â€‹
 =Kx 
k
â€‹
  (i.e., control is a state feedback law).

ğŸ§  Method 2: If You Do Not Know 
ğ¾
K â€” Subspace or Two-Stage DMDc
When 
ğ¾
K is unknown, use a two-step system identification strategy to separate the plant from the controller:

ğŸ§© Step 1: Model Controller Behavior
If you have access to both 
ğ‘¥
ğ‘˜
x 
k
â€‹
  and 
ğ‘¢
ğ‘˜
u 
k
â€‹
 , you can fit the controller model:

ğ‘¢
ğ‘˜
=
ğ¾
ğ‘¥
ğ‘˜
â‡’
FitÂ 
ğ¾
Â viaÂ linearÂ regression:Â 
ğ‘¢
ğ‘˜
â‰ˆ
ğ¾
ğ‘¥
ğ‘˜
u 
k
â€‹
 =Kx 
k
â€‹
 â‡’FitÂ KÂ viaÂ linearÂ regression:Â u 
k
â€‹
 â‰ˆKx 
k
â€‹
 
This gives you an estimated 
ğ¾
^
K
^
 , and now:

ğŸ”§ Step 2: Use DMDc Estimate to Recover 
ğ´
A
Run DMDc to get 
ğ´
closed
A 
closed
â€‹
 , 
ğµ
B.

Then use:

ğ´
^
=
ğ´
closed
âˆ’
ğµ
ğ¾
^
A
^
 =A 
closed
â€‹
 âˆ’B 
K
^
 
This gives you a reasonable estimate of the open-loop 
ğ´
A.

ğŸ” Optional: Use Open-Loop Simulated Input for Validation
To validate your recovered 
ğ´
A, simulate:

ğ‘¥
ğ‘˜
+
1
=
ğ´
ğ‘¥
ğ‘˜
x 
k+1
â€‹
 =Ax 
k
â€‹
 
with zero or small random input, and check if it reproduces known open-loop instability (e.g., pendulum tipping over).

